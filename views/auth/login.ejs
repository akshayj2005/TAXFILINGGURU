<!-- Page Heading -->

<section class="w-full hero-bg py-10 px-4 relative flex flex-col justify-center">
  <div class="max-w-7xl mx-auto relative z-10 text-center w-full">
    <h2 id="page-title" class="text-4xl md:text-5xl font-bold text-white mb-4">
      <%= seo.headings.h1 %>
    </h2>
    <p id="page-subtitle" class="text-gray-100">
      <%= seo.description %>
    </p>
  </div>
</section>
<main class="w-full py-10 md:py-20 px-4 bg-gray-50">
  <div class="max-w-7xl mx-auto">
    <!-- Registration Card -->
    <div class="bg-white rounded-2xl shadow-lg overflow-hidden grid md:grid-cols-2">

      <!-- LEFT IMAGE PAMPHLET -->
      <div id="pamphlet"
        class="relative flex items-center justify-center min-h-[400px] md:min-h-full overflow-hidden p-6 md:p-12">

      </div>

      <!-- RIGHT FORM -->
      <div class="p-8 md:p-14 bg-white flex flex-col justify-center h-full">

        <div class="text-center mb-8">
          <h3 class="text-3xl font-bold text-gray-900 mb-2 font-heading">
            Login to Your Account
          </h3>
          <p class="text-gray-500">Welcome back! Please enter your details.</p>
        </div>

        <form id="loginForm" class="space-y-5">

          <input id="userid" required placeholder="User ID*"
            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none">

          <input id="loginPassword" type="password" required placeholder="Password*"
            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none">

          <button class="w-full py-3 rounded-lg bg-blue-600 text-white font-bold hover:bg-blue-700 transition">
            Login
          </button>

          <div class="flex justify-between text-sm">
            <button type="button" onclick="openForgotPassword()" class="text-blue-600 hover:underline">
              Forgot Password?
            </button>
            <button type="button" onclick="openForgotUserId()" class="text-blue-600 hover:underline">
              Forgot User ID?
            </button>
            <button type="button" onclick="newCustomerAlert()" class="text-blue-600 hover:underline">
              New Customer? Click Here
            </button>


          </div>

        </form>

      </div>
    </div>
    <div id="forgotPasswordModal" class="fixed inset-0 bg-black/60 hidden flex items-center justify-center z-50">

      <div class="bg-white rounded-xl p-8 w-full max-w-md relative">
        <button onclick="closeForgotPassword()" class="absolute top-3 right-3 text-gray-500">âœ•</button>

        <h3 class="text-xl font-bold mb-4">Forgot Password</h3>

        <input id="fp_userid" placeholder="Enter User ID" class="w-full mb-3 px-4 py-3 border rounded-lg">

        <button onclick="sendOtp()" class="w-full bg-blue-600 text-white py-2 rounded-lg mb-4">
          Send OTP
        </button>

        <input id="fp_otp" placeholder="Enter OTP" class="w-full mb-3 px-4 py-3 border rounded-lg">

        <input id="fp_newpass" type="password" placeholder="New Password"
          class="w-full mb-3 px-4 py-3 border rounded-lg">

        <button onclick="resetPassword()" class="w-full bg-green-600 text-white py-2 rounded-lg">
          Reset Password
        </button>
      </div>
    </div>
    <div id="forgotUserIdModal" class="fixed inset-0 bg-black/60 hidden flex items-center justify-center z-50">

      <div class="bg-white rounded-xl p-8 w-full max-w-md relative">
        <button onclick="closeForgotUserId()" class="absolute top-3 right-3 text-gray-500">âœ•</button>

        <h3 class="text-xl font-bold mb-4">Forgot User ID</h3>

        <input placeholder="First Name *" class="w-full mb-3 px-4 py-3 border rounded-lg">
        <input placeholder="Last Name *" class="w-full mb-3 px-4 py-3 border rounded-lg">
        <input placeholder="Email or Phone *" class="w-full mb-4 px-4 py-3 border rounded-lg">

        <button onclick="sendUserId()" class="w-full bg-blue-600 text-white py-2 rounded-lg">
          Get User ID
        </button>
      </div>
    </div>


  </div>
</main>

</div>
<script>
  const type = new URLSearchParams(window.location.search).get("type");

  const pamphlet = document.getElementById("pamphlet");
  const heroTitle = document.getElementById("page-title");
  const heroSubtitle = document.getElementById("page-subtitle");


  let bgImage = "/assets/images/pamphlet-resident.jpg";

  if (type === "nri") {
    bgImage = "/assets/images/pamphlet-nri.jpg";
    heroTitle.innerText = "NRI Login";
    heroSubtitle.innerText =
      "Specialized tax filing for foreign income, DTAA & global compliance. \n Expert handling of overseas income and Indian tax obligations.";
    document.title = "NRI Login - Tax Filing Guru";
  }

  // ---------- LATEST OFFERS CONFIGURATION ----------
  const offersData = {
    badge: "ðŸ”¥ LATEST OFFERS",
    heading: "Save BIG on Tax Filing!",
    description: "Login now to claim your exclusive discounts and benefits for this tax season.",
    features: [
      "Flat 20% OFF on all Premium ITR Filing packages",
      "Free Expert CA Consultation worth â‚¹499",
      "Priority Support & Notice Management for 1 Year"
    ]
  };

  // Render Offers Card inside the pamphlet
  if (pamphlet) {
    pamphlet.innerHTML = `
        <!-- Full Background Layer -->
        <div class="absolute inset-0 z-0">
            <div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 scale-105" 
                 style="background-image: url('${bgImage}'); filter: blur(6px);">
            </div>
            <div class="absolute inset-0 bg-black/15"></div>
        </div>

        <!-- Centered Offers Card (80% width) -->
        <div class="relative z-10 bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-6 md:p-8 w-[80%] border border-white/20">
          
          <div class="inline-block bg-red-100 text-red-600 font-bold px-3 py-1 rounded-full text-xs mb-4 shadow-sm tracking-wide">
            ${offersData.badge}
          </div>
                  
          <h3 class="text-2xl font-bold mb-3 text-gray-900 leading-tight">${offersData.heading}</h3>

          <p class="text-gray-600 text-sm mb-5 leading-relaxed border-b border-gray-200 pb-4">${offersData.description}</p>

          <ul class="space-y-3">
            ${offersData.features.map(f =>
      '<li class="flex items-start text-gray-800 text-sm font-medium">' +
      '<svg class="w-5 h-5 text-green-500 mr-2 shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">' +
      '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>' +
      '</svg>' + f + '</li>'
    ).join("")}
          </ul>
        </div>
      `;
  }
  document.getElementById("loginForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const userId = document.getElementById("userid").value.trim();
    const password = document.getElementById("loginPassword").value.trim();

    if (!userId || !password) {
      showPopup({ title: 'Input Required', message: 'Please enter both User ID and Password.', type: 'warning' });
      return;
    }

    // ----------------------------
    // DEFAULT CREDENTIALS
    // ----------------------------
    const credentials = {
      resident: {
        userid: "resident",
        password: "resident123"
      },
      nri: {
        userid: "nri",
        password: "nri123"
      }
    };

    // ----------------------------
    // LOGIN TYPE FROM URL
    // ----------------------------
    const type = new URLSearchParams(window.location.search).get("type") || "resident";

    // ----------------------------
    // CREDENTIAL CHECK
    // ----------------------------
    if (
      type === "resident" &&
      userId === credentials.resident.userid &&
      password === credentials.resident.password
    ) {
      // Example: resident beginner
      localStorage.setItem("loginType", "residentbeginner");
      showPopup({
        title: 'Login Successful',
        message: 'Welcome back! Redirecting to your dashboard...',
        type: 'success',
        callback: () => onLoginSuccess()
      });
      return;
    }

    if (
      type === "nri" &&
      userId === credentials.nri.userid &&
      password === credentials.nri.password
    ) {
      // Example: nri beginner
      localStorage.setItem("loginType", "nribeginner");
      showPopup({
        title: 'Login Successful',
        message: 'Welcome back! Redirecting to your NRI dashboard...',
        type: 'success',
        callback: () => onLoginSuccess()
      });
      return;
    }

    // ----------------------------
    // INVALID
    // ----------------------------
    showPopup({ title: 'Login Failed', message: 'Invalid User ID or Password. Please try again.', type: 'error' });
  });

  // ----------------------------
  // YOUR REDIRECT FUNCTION (UNCHANGED)
  // ----------------------------
  function onLoginSuccess() {
    const loginType = localStorage.getItem("loginType");

    if (loginType === "residentexisting") {
      window.location.href = "/existing-dashboard";
    }
    else if (loginType === "residentbeginner") {
      window.location.href = "/beginner-dashboard";
    }
    else if (loginType === "nriexisting") {
      window.location.href = "/existing-dashboard";
    }
    else if (loginType === "nribeginner") {
      window.location.href = "/beginner-dashboard";
    }
    else {
      window.location.href = "/";
    }

    localStorage.removeItem("loginType");
  }

  function openForgotPassword() {
    document.getElementById("forgotPasswordModal").classList.remove("hidden");
  }
  function closeForgotPassword() {
    document.getElementById("forgotPasswordModal").classList.add("hidden");
  }

  function openForgotUserId() {
    document.getElementById("forgotUserIdModal").classList.remove("hidden");
  }
  function closeForgotUserId() {
    document.getElementById("forgotUserIdModal").classList.add("hidden");
  }

  function sendOtp() {
    showPopup({ title: 'OTP Sent', message: 'ðŸ“© OTP has been sent to your registered Email and Phone.', type: 'info' });
  }

  function resetPassword() {
    showPopup({
      title: 'Success',
      message: 'âœ… Password successfully changed.',
      type: 'success',
      callback: () => closeForgotPassword()
    });
  }

  function sendUserId() {
    showPopup({
      title: 'User ID Sent',
      message: 'ðŸ“§ Your User ID has been sent to your registered Email and Phone.',
      type: 'info',
      callback: () => closeForgotUserId()
    });
  }
  function newCustomerAlert() {
    showPopup({
      title: 'New Customer?',
      message: 'You need to choose Resident or NRI before continuing.',
      type: 'info',
      showCancel: true,
      confirmText: 'Go to Main Page',
      callback: (confirmed) => {
        if (confirmed) {
          window.location.href = "/";
        }
      }
    });
  }
</script>
<script src="js/script.js"></script>