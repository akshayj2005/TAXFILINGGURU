<section class="w-full hero-bg py-10 px-4 relative flex flex-col justify-center">
  <div class="max-w-7xl mx-auto relative z-10 text-center w-full">
    <h2 class="font-heading text-5xl md:text-6xl font-extrabold text-white mb-6 tracking-tight drop-shadow-sm">
      NRI Status <span class="text-gray-100">Tracker</span>
    </h2>
    <p class="text-lg text-gray-100 max-w-2xl mx-auto font-light">
      Determine your exact residential status based on your stay in India.
    </p>
  </div>
</section>

<div class="max-w-4xl mx-auto py-12 px-4">
  <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100 p-8 md:p-12">
    <form id="nriForm" class="space-y-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Days stayed in India during the current FY (April 1
          - March 31)</label>
        <input type="number" id="daysInIndia" required placeholder="e.g., 45"
          class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Total days stayed in India in the past 4 Financial
          Years</label>
        <input type="number" id="daysInIndiaPast4Years" required placeholder="e.g., 300"
          class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
      </div>

      <div class="flex items-center space-x-3">
        <input type="checkbox" id="isIndianCitizen" checked
          class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 border-gray-300">
        <label for="isIndianCitizen" class="text-gray-700 font-medium">I am an Indian Citizen or Person of Indian Origin
          (PIO)</label>
      </div>

      <div class="flex items-center space-x-3">
        <input type="checkbox" id="incomeInIndiaExceeds15L"
          class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 border-gray-300">
        <label for="incomeInIndiaExceeds15L" class="text-gray-700 font-medium">My total income in India exceeds â‚¹15
          Lakhs</label>
      </div>

      <button type="submit"
        class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-4 rounded-xl transition-all shadow-lg transform hover:scale-[1.02]">
        Check My Status
      </button>
    </form>

    <div id="result" class="hidden mt-8 p-6 bg-blue-50 rounded-2xl border border-blue-100 text-center">
      <p class="text-gray-600 mb-2 font-medium">Your Residential Status is:</p>
      <h3 class="text-3xl font-black text-blue-800" id="statusText">Pending...</h3>
      <p class="text-sm text-gray-500 mt-4 italic">Based on Section 6 of the Income Tax Act, 1961.</p>
    </div>
  </div>
</div>

<script>
  document.getElementById('nriForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const daysInIndia = document.getElementById('daysInIndia').value;
    const daysInIndiaPast4Years = document.getElementById('daysInIndiaPast4Years').value;
    const isIndianCitizen = document.getElementById('isIndianCitizen').checked;
    const incomeInIndiaExceeds15L = document.getElementById('incomeInIndiaExceeds15L').checked;

    const response = await fetch('/api/calculate-nri-status', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ daysInIndia, daysInIndiaPast4Years, isIndianCitizen, incomeInIndiaExceeds15L })
    });

    const data = await response.json();

    if (data.status) {
      document.getElementById('result').classList.remove('hidden');
      document.getElementById('statusText').innerText = data.status;

      // Dynamic Styling based on result
      const resultBox = document.getElementById('result');
      const statusText = document.getElementById('statusText');

      if (data.status.includes('Non-Resident')) {
        resultBox.className = "mt-8 p-6 bg-green-50 rounded-2xl border border-green-100 text-center";
        statusText.className = "text-3xl font-black text-green-700";
      } else if (data.status.includes('RNOR')) {
        resultBox.className = "mt-8 p-6 bg-yellow-50 rounded-2xl border border-yellow-100 text-center";
        statusText.className = "text-3xl font-black text-yellow-700";
      } else {
        resultBox.className = "mt-8 p-6 bg-blue-50 rounded-2xl border border-blue-100 text-center";
        statusText.className = "text-3xl font-black text-blue-800";
      }
    } else {
      showPopup({ title: 'Calculation Failed', message: 'Something went wrong during calculation. Please try again.', type: 'error' });
    }
  });
</script>